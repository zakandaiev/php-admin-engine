"use strict";class Translation{constructor(t){this.node=t,this.data_action=this.node.hasAttribute("data-action")?this.node.getAttribute("data-action"):window.location.href,this.initialize()}initialize(){this.node.contentEditable=!0,this.node.spellcheck=!1,this.colorize(),this.watchChanges()}colorize(){let t=this.node.innerText;return t=t.replace(/^(^[;|#][^[\n]*)/gimu,'<span class="translation__comment">$1</span>'),this.node.innerHTML=t,!0}watchChanges(){return this.node.addEventListener("focusout",(()=>{this.postChanges(),this.colorize()})),!0}postChanges(){var t;return null===(t=this.node.closest(".spinner-action"))||void 0===t||t.classList.add("spinner-action_active"),fetch(this.data_action,{method:"POST",body:this.getFormData()}).then((t=>t.json())).then((t=>{SETTING.toast(t.status,t.message)})).catch((t=>{SETTING.toast("error",t)})).finally((()=>{var t;null===(t=this.node.closest(".spinner-action"))||void 0===t||t.classList.remove("spinner-action_active")})),!0}getFormData(){let t=new FormData;return t.set("content",this.node.innerText),t.set(SETTING.csrf.key,SETTING.csrf.token),t}}document.querySelectorAll(".translation").forEach((t=>{new Translation(t)}));