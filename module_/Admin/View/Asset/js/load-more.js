"use strict";class LoadMore{constructor(t){var a;let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.node=t,this.options=e,this.data_action=this.node.getAttribute("data-load-more"),this.data_method=this.node.hasAttribute("data-method")?this.node.getAttribute("data-method"):"POST",this.data_event=this.node.hasAttribute("data-event")?this.node.getAttribute("data-event"):"click",this.data_target=this.node.getAttribute("data-target"),this.data_target_position=this.node.hasAttribute("data-target-position")?this.node.getAttribute("data-target-position"):"beforeend",this.data_class=this.node.getAttribute("data-class"),this.data_class_target=this.node.getAttribute("data-class-target"),this.data_uri_key=this.node.hasAttribute("data-uri-key")?this.node.getAttribute("data-uri-key"):"page",this.data_page=this.node.hasAttribute("data-page")?parseInt(this.node.getAttribute("data-page")):1,this.data_total=parseInt(this.node.getAttribute("data-total")),this.pagination_limit=parseInt(null===(a=SETTING)||void 0===a?void 0:a.pagination_limit),this.data_output=null,this.data_page*this.pagination_limit>=this.data_total?this.node.remove():this.data_action&&this.data_target&&this.data_total&&this.pagination_limit&&this.initialize()}initialize(){this.node.addEventListener(this.data_event,(t=>{t.preventDefault(),this.disableNodes();const a=this.data_action+"?"+this.data_uri_key+"="+ ++this.data_page;fetch(a,{method:this.data_method,body:this.getFormData()}).then((t=>t.text())).then((t=>{this.data_output=t,this.output()})).catch((t=>{SETTING.toast("error",t)})).finally((()=>{this.enableNodes()}))}))}getFormData(){let t=new FormData,a=[];return this.options.data&&(a=a.concat(this.options.data)),a.forEach((a=>{a.key&&t.set(a.key,a.value?a.value:null)})),t}disableNodes(){return this.node.setAttribute("disabled","disabled"),this.node.classList.add("disabled"),this.data_class&&this.data_class_target?document.querySelectorAll(this.data_class_target).forEach((t=>{t.classList.add(this.data_class)})):this.data_class&&this.node.classList.add(this.data_class),!0}enableNodes(){return this.node.removeAttribute("disabled","disabled"),this.node.classList.remove("disabled"),this.data_class&&this.data_class_target?document.querySelectorAll(this.data_class_target).forEach((t=>{t.classList.remove(this.data_class)})):this.data_class&&this.node.classList.remove(this.data_class),!0}output(){var t;const a=document.querySelector(this.data_target);return!(!a||!this.data_output)&&(a.insertAdjacentHTML(this.data_target_position,this.data_output),null===(t=feather)||void 0===t||t.replace(),this.data_page*this.pagination_limit>=this.data_total&&fadeOut(this.node),!0)}}document.querySelectorAll("[data-load-more]").forEach((t=>{new LoadMore(t,{data:[{key:SETTING.csrf.key,value:SETTING.csrf.token}]})}));